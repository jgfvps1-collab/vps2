<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaggle VPS Control Panel</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            display: flex;
            align-items: center;
            gap: 15px;
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .status-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .status-item {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #3498db;
        }
        
        .status-item.online { border-left-color: #27ae60; }
        .status-item.warning { border-left-color: #f39c12; }
        .status-item.error { border-left-color: #e74c3c; }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .panel {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .panel h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4em;
        }
        
        .button-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .btn {
            background: linear-gradient(145deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .btn.success { background: linear-gradient(145deg, #27ae60, #219a52); }
        .btn.warning { background: linear-gradient(145deg, #f39c12, #e67e22); }
        .btn.danger { background: linear-gradient(145deg, #e74c3c, #c0392b); }
        
        .log-container {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.4;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        
        .log-entry.info { color: #3498db; }
        .log-entry.success { color: #27ae60; }
        .log-entry.warning { color: #f39c12; }
        .log-entry.error { color: #e74c3c; }
        
        .resource-meter {
            margin: 15px 0;
        }
        
        .meter-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .progress-bar {
            background: #ecf0f1;
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            border-radius: 10px;
            transition: width 0.3s ease;
            position: relative;
        }
        
        .progress-fill.warning { background: linear-gradient(90deg, #f39c12, #e67e22); }
        .progress-fill.danger { background: linear-gradient(90deg, #e74c3c, #c0392b); }
        
        .session-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .info-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .info-card h4 {
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }
        
        .modal-content {
            background: white;
            margin: 15% auto;
            padding: 30px;
            border-radius: 15px;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .full-width { grid-column: 1 / -1; }
        
        @media (max-width: 768px) {
            .grid { grid-template-columns: 1fr; }
            .session-info { grid-template-columns: 1fr; }
            .button-group { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-server"></i> Kaggle VPS Control Panel</h1>
            <div class="status-bar">
                <div class="status-item online" id="connection-status">
                    <i class="fas fa-wifi"></i> Connection: <span id="connection-text">Online</span>
                </div>
                <div class="status-item" id="session-status">
                    <i class="fas fa-clock"></i> Session: <span id="session-text">Inactive</span>
                </div>
                <div class="status-item" id="backup-status">
                    <i class="fas fa-save"></i> Last Backup: <span id="backup-text">Never</span>
                </div>
                <div class="status-item" id="uptime-status">
                    <i class="fas fa-hourglass-half"></i> Uptime: <span id="uptime-text">00:00:00</span>
                </div>
            </div>
        </div>
        
        <div class="grid">
            <div class="panel">
                <h2><i class="fas fa-play-circle"></i> Session Control</h2>
                <div class="button-group">
                    <button class="btn success" onclick="startSession()">
                        <i class="fas fa-play"></i> Start Session
                    </button>
                    <button class="btn danger" onclick="stopSession()">
                        <i class="fas fa-stop"></i> Stop Session
                    </button>
                    <button class="btn warning" onclick="restartSession()">
                        <i class="fas fa-redo"></i> Restart
                    </button>
                    <button class="btn" onclick="connectVNC()">
                        <i class="fas fa-desktop"></i> Open VNC
                    </button>
                </div>
                
                <div class="session-info">
                    <div class="info-card">
                        <h4>Session ID</h4>
                        <span id="session-id">Not Active</span>
                    </div>
                    <div class="info-card">
                        <h4>Kernel Type</h4>
                        <span id="kernel-type">GPU Enabled</span>
                    </div>
                    <div class="info-card">
                        <h4>Region</h4>
                        <span id="session-region">US-Central</span>
                    </div>
                    <div class="info-card">
                        <h4>Runtime</h4>
                        <span id="session-runtime">Python 3.8</span>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2><i class="fas fa-chart-area"></i> Resource Monitor</h2>
                
                <div class="resource-meter">
                    <div class="meter-label">
                        <span>CPU Usage</span>
                        <span id="cpu-usage">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="cpu-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="resource-meter">
                    <div class="meter-label">
                        <span>Memory Usage</span>
                        <span id="memory-usage">0 GB / 16 GB</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="memory-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="resource-meter">
                    <div class="meter-label">
                        <span>GPU Memory</span>
                        <span id="gpu-usage">0 GB / 16 GB</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="gpu-bar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="resource-meter">
                    <div class="meter-label">
                        <span>Disk Space</span>
                        <span id="disk-usage">0 GB / 100 GB</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="disk-bar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="grid">
            <div class="panel">
                <h2><i class="fas fa-database"></i> Backup & Restore</h2>
                <div class="button-group">
                    <button class="btn success" onclick="createBackup()">
                        <i class="fas fa-save"></i> Save Session
                    </button>
                    <button class="btn" onclick="restoreBackup()">
                        <i class="fas fa-upload"></i> Restore
                    </button>
                    <button class="btn warning" onclick="autoSave()">
                        <i class="fas fa-clock"></i> Auto-Save
                    </button>
                    <button class="btn" onclick="viewBackups()">
                        <i class="fas fa-history"></i> History
                    </button>
                </div>
                
                <div class="session-info">
                    <div class="info-card">
                        <h4>Last Backup Size</h4>
                        <span id="backup-size">0 MB</span>
                    </div>
                    <div class="info-card">
                        <h4>Auto-Save</h4>
                        <span id="autosave-status">Disabled</span>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2><i class="fas fa-tools"></i> Quick Actions</h2>
                <div class="button-group">
                    <button class="btn" onclick="openJupyter()">
                        <i class="fas fa-book"></i> Jupyter Lab
                    </button>
                    <button class="btn" onclick="openTerminal()">
                        <i class="fas fa-terminal"></i> Terminal
                    </button>
                    <button class="btn" onclick="openFileManager()">
                        <i class="fas fa-folder"></i> Files
                    </button>
                    <button class="btn" onclick="installPackages()">
                        <i class="fas fa-download"></i> Packages
                    </button>
                </div>
                
                <div class="button-group">
                    <button class="btn" onclick="checkHealth()">
                        <i class="fas fa-heartbeat"></i> Health Check
                    </button>
                    <button class="btn" onclick="viewLogs()">
                        <i class="fas fa-file-alt"></i> View Logs
                    </button>
                    <button class="btn" onclick="systemInfo()">
                        <i class="fas fa-info-circle"></i> System Info
                    </button>
                    <button class="btn danger" onclick="emergencyStop()">
                        <i class="fas fa-exclamation-triangle"></i> Emergency
                    </button>
                </div>
            </div>
        </div>
        
        <div class="panel full-width">
            <h2><i class="fas fa-terminal"></i> System Logs</h2>
            <div class="log-container" id="log-container">
                <div class="log-entry info">[INFO] Control panel initialized</div>
                <div class="log-entry success">[SUCCESS] Connected to monitoring system</div>
                <div class="log-entry info">[INFO] Waiting for session commands...</div>
            </div>
        </div>
    </div>
    
    <!-- Modal for dialogs -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title">Action Required</h3>
            <p id="modal-message">Please confirm your action.</p>
            <div style="text-align: right; margin-top: 20px;">
                <button class="btn" onclick="closeModal()">Cancel</button>
                <button class="btn success" onclick="confirmAction()" style="margin-left: 10px;">Confirm</button>
            </div>
        </div>
    </div>
    
    <script>
        // Global state
        let sessionActive = false;
        let autoSaveEnabled = false;
        let startTime = null;
        let uptimeInterval = null;
        let resourceInterval = null;
        let currentAction = null;
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            logMessage('Control panel loaded successfully', 'success');
            startResourceMonitoring();
            checkSessionStatus();
        });
        
        // Logging functions
        function logMessage(message, type = 'info') {
            const container = document.getElementById('log-container');
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${timestamp}] [${type.toUpperCase()}] ${message}`;
            container.appendChild(entry);
            container.scrollTop = container.scrollHeight;
            
            // Keep only last 100 entries
            while (container.children.length > 100) {
                container.removeChild(container.firstChild);
            }
        }
        
        // Session management
        async function startSession() {
            try {
                logMessage('Starting Kaggle session...', 'info');
                showModal('Start Session', 'This will create a new Kaggle notebook with GPU enabled. Continue?', 'startSessionConfirm');
            } catch (error) {
                logMessage(`Failed to start session: ${error.message}`, 'error');
            }
        }
        
        async function startSessionConfirm() {
            sessionActive = true;
            startTime = new Date();
            
            document.getElementById('session-status').className = 'status-item online';
            document.getElementById('session-text').textContent = 'Active';
            document.getElementById('session-id').textContent = 'kaggle-' + Math.random().toString(36).substr(2, 8);
            
            startUptimeCounter();
            logMessage('Session started successfully', 'success');
            logMessage('Initializing environment...', 'info');
            
            // Simulate initialization
            setTimeout(() => {
                logMessage('Environment setup complete', 'success');
                logMessage('VNC server started on port 5901', 'info');
                logMessage('Session ready for use', 'success');
            }, 2000);
        }
        
        async function stopSession() {
            showModal('Stop Session', 'This will terminate the current session. Make sure to save your work first!', 'stopSessionConfirm');
        }
        
        async function stopSessionConfirm() {
            sessionActive = false;
            stopUptimeCounter();
            
            document.getElementById('session-status').className = 'status-item error';
            document.getElementById('session-text').textContent = 'Stopped';
            document.getElementById('session-id').textContent = 'Not Active';
            
            logMessage('Session stopped', 'warning');
        }
        
        async function restartSession() {
            logMessage('Restarting session...', 'warning');
            await stopSessionConfirm();
            setTimeout(startSessionConfirm, 1000);
        }
        
        // Backup functions
        async function createBackup() {
            if (!sessionActive) {
                logMessage('Cannot create backup: No active session', 'error');
                return;
            }
            
            logMessage('Creating session backup...', 'info');
            const backupSize = Math.floor(Math.random() * 500) + 50; // Simulate size
            
            setTimeout(() => {
                document.getElementById('backup-size').textContent = `${backupSize} MB`;
                document.getElementById('backup-text').textContent = new Date().toLocaleTimeString();
                document.getElementById('backup-status').className = 'status-item online';
                logMessage(`Backup created successfully (${backupSize} MB)`, 'success');
            }, 2000);
        }
        
        async function restoreBackup() {
            showModal('Restore Backup', 'This will restore your previous session state. Current unsaved work will be lost!', 'restoreBackupConfirm');
        }
        
        async function restoreBackupConfirm() {
            logMessage('Restoring from backup...', 'info');
            
            setTimeout(() => {
                logMessage('Backup restored successfully', 'success');
                logMessage('Environment ready', 'info');
            }, 3000);
        }
        
        async function autoSave() {
            autoSaveEnabled = !autoSaveEnabled;
            document.getElementById('autosave-status').textContent = autoSaveEnabled ? 'Every 1 hour' : 'Disabled';
            
            if (autoSaveEnabled) {
                logMessage('Auto-save enabled (1 hour interval)', 'success');
                // Start auto-save interval
                setInterval(() => {
                    if (sessionActive) {
                        createBackup();
                    }
                }, 3600000); // 1 hour
            } else {
                logMessage('Auto-save disabled', 'warning');
            }
        }
        
        // Quick actions
        async function openJupyter() {
            if (!sessionActive) {
                logMessage('Cannot open Jupyter: No active session', 'error');
                return;
            }
            logMessage('Opening Jupyter Lab...', 'info');
            window.open('https://www.kaggle.com', '_blank');
        }
        
        async function connectVNC() {
            if (!sessionActive) {
                logMessage('Cannot connect VNC: No active session', 'error');
                return;
            }
            logMessage('Opening VNC connection...', 'info');
            window.open('http://localhost:6080', '_blank');
        }
        
        async function openTerminal() {
            if (!sessionActive) {
                logMessage('Cannot open terminal: No active session', 'error');
                return;
            }
            logMessage('Opening web terminal...', 'info');
        }
        
        async function checkHealth() {
            logMessage('Running health check...', 'info');
            
            setTimeout(() => {
                logMessage('✓ CPU: Normal', 'success');
                logMessage('✓ Memory: Normal', 'success');
                logMessage('✓ GPU: Available', 'success');
                logMessage('✓ Network: Connected', 'success');
                logMessage('Health check completed', 'success');
            }, 1000);
        }
        
        // Resource monitoring
        function startResourceMonitoring() {
            resourceInterval = setInterval(updateResources, 2000);
        }
        
        function updateResources() {
            if (!sessionActive) return;
            
            // Simulate resource usage
            const cpu = Math.random() * 100;
            const memory = Math.random() * 16;
            const gpu = Math.random() * 16;
            const disk = Math.random() * 100;
            
            updateProgressBar('cpu-bar', cpu, 'cpu-usage', `${cpu.toFixed(1)}%`);
            updateProgressBar('memory-bar', (memory/16)*100, 'memory-usage', `${memory.toFixed(1)} GB / 16 GB`);
            updateProgressBar('gpu-bar', (gpu/16)*100, 'gpu-usage', `${gpu.toFixed(1)} GB / 16 GB`);
            updateProgressBar('disk-bar', disk, 'disk-usage', `${disk.toFixed(1)} GB / 100 GB`);
        }
        
        function updateProgressBar(barId, percentage, labelId, text) {
            const bar = document.getElementById(barId);
            const label = document.getElementById(labelId);
            
            bar.style.width = percentage + '%';
            label.textContent = text;
            
            // Update color based on usage
            bar.className = 'progress-fill';
            if (percentage > 80) bar.classList.add('danger');
            else if (percentage > 60) bar.classList.add('warning');
        }
        
        // Uptime counter
        function startUptimeCounter() {
            uptimeInterval = setInterval(() => {
                if (startTime) {
                    const now = new Date();
                    const diff = now - startTime;
                    const hours = Math.floor(diff / 3600000);
                    const minutes = Math.floor((diff % 3600000) / 60000);
                    const seconds = Math.floor((diff % 60000) / 1000);
                    
                    const timeStr = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    document.getElementById('uptime-text').textContent = timeStr;
                }
            }, 1000);
        }
        
        function stopUptimeCounter() {
            if (uptimeInterval) {
                clearInterval(uptimeInterval);
                uptimeInterval = null;
            }
            document.getElementById('uptime-text').textContent = '00:00:00';
        }
        
        // Modal functions
        function showModal(title, message, action) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-message').textContent = message;
            document.getElementById('modal').style.display = 'block';
            currentAction = action;
        }
        
        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            currentAction = null;
        }
        
        async function confirmAction() {
            if (currentAction && window[currentAction]) {
                await window[currentAction]();
            }
            closeModal();
        }
        
        // Additional functions
        async function checkSessionStatus() {
            // This would normally check the actual Kaggle API
            logMessage('Checking session status...', 'info');
        }
        
        async function viewBackups() {
            logMessage('Loading backup history...', 'info');
            // Show backup list
        }
        
        async function installPackages() {
            logMessage('Opening package manager...', 'info');
        }
        
        async function openFileManager() {
            logMessage('Opening file manager...', 'info');
        }
        
        async function viewLogs() {
            logMessage('Showing detailed logs...', 'info');
        }
        
        async function systemInfo() {
            logMessage('System Info:', 'info');
            logMessage('OS: Ubuntu 20.04 LTS', 'info');
            logMessage('CPU: 4 cores, Intel Xeon', 'info');
            logMessage('RAM: 16 GB DDR4', 'info');
            logMessage('GPU: Tesla P100 (16 GB)', 'info');
            logMessage('Storage: 100 GB SSD', 'info');
        }
        
        async function emergencyStop() {
            showModal('Emergency Stop', '⚠️ This will immediately terminate all processes and stop the session!', 'emergencyStopConfirm');
        }
        
        async function emergencyStopConfirm() {
            logMessage('EMERGENCY STOP INITIATED', 'error');
            sessionActive = false;
            stopUptimeCounter();
            document.getElementById('session-status').className = 'status-item error';
            document.getElementById('session-text').textContent = 'Emergency Stop';
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            if (event.target == modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>
